<h3 id="how-to-decommission-unused-template-deploy-services">How to decommission unused template deploy services</h3><h4 id="1-stack-deletion-will-also-delete-related-instances-vpu-s-security-groups-network-gateways-etc">1. Stack Deletion (will also delete related instances, vpu’s, security groups, network gateways etc).</h4><p>NOTE As a first port of call we would recommend raising a support ticket in <a href="https://mojdt.slack.com/messages/C57UPMZLY/team/U58MLFA0M/">#ask-cloud-platform</a> requesting that cloud-platform delete your AWS stack.</p>
<p>In most cases cloud-platform’s will have the necessary credentials to delete the stack for you (most template-deploy stacks will have been created within the mojdsd AWS account).</p>
<p>NOTE Caution should also be taken as AWS Route53 dns configuration may be deleted (and this could be referenced in new AWS account Kubernetes setups). We would recommend making a copy of any such configuration so that it can be reinstated if necessary. 
Should you wish to go ahead yourselves, whilst it is possible to delete from the AWS stack dashboard, for a cleaner operation (the deleting of related AWS resources) the following fabric command should be carried out:</p>
<p>in order to proceed, you need to have :</p>

<ul>
<li>installed the prerequisite tools</li>
<li>configured your AWS credentials</li>
<li>configured your github access</li>
<li>create your own GPG key</li>
</ul>
<p>a.   Run <a href="https://dsdmoj.atlassian.net/wiki/spaces/PLAT/pages/82640903/Quickstart+-+Template+Deploy">mkvirtualenv</a> to create your local environment.</p>
<p>b.   Run the fabric command to delete your stack</p>
<p>The Fabric command to delete an AWS stack:</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ fab aws:&lt;awsaccountname&gt; environment:&lt;environmentname&gt; application:&lt;projectname&gt; config:cloudformation/&lt;projectname&gt;.yaml  passwords:cloudformation/&lt;projectname&gt;-secrets.yaml -u &lt;githubsshkey&gt; cfn_delete
</code></pre></div><h4 id="2-jenkins-projects">2. Jenkins Projects:</h4><p>NOTE If you do not have the necessary permissions to carry out the following actions, raise a support ticket in [#ask-cloud-platform](https://mojdt.slack.com/messages/C57UPMZLY/team/U58MLFA0M/</p>
<p>a.   Disable the project (if you wish to retain the configuration for reference):</p>
<div class="highlight"><pre class="highlight plaintext"><code>i.   Locate your project’s job:

ii.  Click on the “Disable Project” button:
</code></pre></div><p><a href="https://i.stack.imgur.com/n77nl.png" target="_blank" rel="noopener noreferrer"><img src="https://i.stack.imgur.com/n77nl.png" alt="Image description" /></a></p>
<div class="highlight"><pre class="highlight plaintext"><code>iii. If you wish to resurrect your project job, click on “Enable” button: 
</code></pre></div><p>b.   Delete the project (if you no longer require the Jenkins deploy config):</p>
<div class="highlight"><pre class="highlight plaintext"><code>i.   Click on “Delete Project”:
</code></pre></div><p><a href="https://issues.jenkins-ci.org/secure/attachment/31690/upload.png" target="_blank" rel="noopener noreferrer"><img src="https://issues.jenkins-ci.org/secure/attachment/31690/upload.png" alt="Image description" /></a></p>
<h4 id="3-github-deploy-repos-this-should-take-place-after-you-have-deleted-the-aws-resources">3. Github deploy repos (this should take place after you have deleted the AWS resources)</h4><p>NOTE If you do not have the necessary permissions to carry out the following actions, raise a support ticket in [#ask-cloud-platform](https://mojdt.slack.com/messages/C57UPMZLY/team/U58MLFA0M/</p>
<p>a.   <a href="https://help.github.com/en/articles/archiving-repositories">Archive the Github deploy repos</a>  (if you still require the deploy configuration for reference)</p>
<div class="highlight"><pre class="highlight plaintext"><code>i.   Locate your deploy-repos. Click on the “Settings” button:

ii.  Click on the “Archive this repository” button:

iii. Type in the name of the repository and then click “I understand the consequences, archive this repository”:

iv.  The deploy repository will then be archived (confirmatory message will appear):
</code></pre></div><p>b.   <a href="https://help.github.com/en/articles/deleting-a-repository">Delete the Github deploy repos</a>  (if you no longer require the deploy configuration for reference)</p>
<div class="highlight"><pre class="highlight plaintext"><code>i.   As for archiving -Locate your deploy-repos. Click on the “Settings” button. Then click on the “Delete this repository” button:
</code></pre></div><h4 id="4-docker-images">4. Docker Images:</h4><p>a.   The docker image repository will be completely decommissioned when we have switched everything over from template-deploy</p>
